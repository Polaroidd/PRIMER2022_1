#!/usr/bin/env python3

import subprocess

print("\n")
print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□■□□□□□□□■□■■■■■■■□■□□□□□□□□■■■■■■□□■■■■■□□■■□□□□■■□■■■■■■■□□□□□□□□□□■■■■■■■□□■■■■■□□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□■□□□□□□□■□■□□□□□□□■□□□□□□□■□□□□□□□■□□□□□■□■□■□□■□■□■□□□□□□□□□□□□□□□□□□□■□□□□■□□□□□■□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□■□□□■□□□■□■■■■■■□□■□□□□□□□■□□□□□□□■□□□□□■□■□□■■□□■□■■■■■■□□□□□□□□□□□□□□■□□□□■□□□□□■□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□□■□■□■□■□□■□□□□□□□■□□□□□□□■□□□□□□□■□□□□□■□■□□□□□□■□■□□□□□□□□□□□□□□□□□□□■□□□□■□□□□□■□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□□□■□□□■□□□■■■■■■■□■■■■■■■□□■■■■■■□□■■■■■□□■□□□□□□■□■■■■■■■□□□□□□□□□□□□□■□□□□□■■■■■□□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")

print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□■■■■■■□□■■■■■■□□■■■■■■■□■■□□□□■■□■■■■■■■□■■■■■■□□□□□□□□□□□■□□□□□□□■□□■■■■■□□■■■■■■□□■□□□□□□□■■■■■□□□□□□■■□□□□□□□□□")
print("□□□□□□□□□■□□□□□■□■□□□□□■□□□□■□□□□■□■□□■□■□■□□□□□□□■□□□□□■□□□□□□□□□□■□□□□□□□■□■□□□□□■□■□□□□□■□■□□□□□□□■□□□□■□□□□□■■□□□□□□□□□")
print("□□□□□□□□□■■■■■■□□■■■■■■□□□□□■□□□□■□□■■□□■□■■■■■■□□■■■■■■□□□□□□□□□□□■□□□■□□□■□■□□□□□■□■■■■■■□□■□□□□□□□■□□□□■■□□□□■■□□□□□□□□□")
print("□□□□□□□□□■□□□□□□□■□□□□■□□□□□■□□□□■□□□□□□■□■□□□□□□□■□□□□■□□□□□□□□□□□□■□■□■□■□□■□□□□□■□■□□□□■□□■□□□□□□□■□□□□■□□□□□□□□□□□□□□□□")
print("□□□□□□□□□■□□□□□□□■□□□□□■□■■■■■■■□■□□□□□□■□■■■■■■■□■□□□□□■□□□□□□□□□□□□■□□□■□□□□■■■■■□□■□□□□□■□■■■■■■■□■■■■■□□□□□□■■□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")


#print("■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■□■■■■■■■□■□□□□□□□■□■■■■■■■■□□□□□□■■□□□□□■■□□■■■■□□■□□□□□□□■■■■■■■■■■□□□□□□□■■□□□□□■■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■□■■■■■■■□■□■■■■■■■□■■■■■■■□■■■■■■■□■■■■■□■□■□■■□■□■□■■■■■■■■■■■■■■■■■■■□■■■■□■■■■■□■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■□■■■□■■■□■□□□□□□■■□■■■■■■■□■■■■■■■□■■■■■□■□■■□□■■□■□□□□□□■■■■■■■■■■■■■■□■■■■□■■■■■□■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■■□■□■□■□■■□■■■■■■■□■■■■■■■□■■■■■■■□■■■■■□■□■■■■■■□■□■■■■■■■■■■■■■■■■■■■□■■■■□■■■■■□■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■■■□■■■□■■■□□□□□□□■□□□□□□□■■□□□□□□■■□□□□□■■□■■■■■■□■□□□□□□□■■■■■■■■■■■■■□■■■■■□□□□□■■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■")

#print("■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■□□□□□□■■□□□□□□■■□□□□□□□■□□■■■■□□■□□□□□□□■□□□□□□■■■■■■■■■■■□■■■■■■■□■■□□□□□■■□□□□□□■■□■■■■■■■□□□□□■■■■■■□□■■■■■■■■■")
#print("■■■■■■■■■□■■■■■□■□■■■■■□■■■■□■■■■□■□■■□■□■□■■■■■■■□■■■■■□■■■■■■■■■■□■■■■■■■□■□■■■■■□■□■■■■■□■□■■■■■■■□■■■■□■■■■■□□■■■■■■■■■")
#print("■■■■■■■■■□□□□□□■■□□□□□□■■■■■□■■■■□■■□□■■□■□□□□□□■■□□□□□□■■■■■■■■■■■□■■■□■■■□■□■■■■■□■□□□□□□■■□■■■■■■■□■■■■□□■■■■□□■■■■■■■■■")
#print("■■■■■■■■■□■■■■■■■□■■■■□■■■■■□■■■■□■■■■■■□■□■■■■■■■□■■■■□■■■■■■■■■■■■□■□■□■□■■□■■■■■□■□■■■■□■■□■■■■■■■□■■■■□■■■■■■■■■■■■■■■■")
#print("■■■■■■■■■□■■■■■■■□■■■■■□■□□□□□□□■□■■■■■■□■□□□□□□□■□■■■■■□■■■■■■■■■■■■□■■■□■■■■□□□□□■■□■■■■■□■□□□□□□□■□□□□□■■■■■■□□■■■■■■■■■")
#print("■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■")



###load given database
database = "./database.fa"

DB = {}
species = []
values = []
key = ''
value = []
for line in open(database):
	line = line.rstrip()
	if line[0] == ">":
		if key != '':
			DB[key] = value
			species.append(key)
			values.append(value)
			value = []
		key = line[1:]	
	else:
		value.append(line)
	
DB[key] = value
species.append(key)
values.append(value)


#print(DB)
#print(species)
#print(values)



###Run Program
while True:
	print("\n---------------------------------------------------------------------------------------------------------------------------\n")
	print("\n<BEFORE GO TO THE MENU>\n")
	
	print("- For Value -")
	print("1. \"database\" to  show our database")
	print("2. A DNA sequence that you want to know (e.g. ATGCGCGTA)")
	print("3. A Protein sequence that you want to know (e.g. FSAVLTAWCD)")
	print("4. \"exit\" to end the program\n")
	
	value = input("Write a value : ")
	
	if value == 'exit':
		
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□■■■■■■■■■□■□□□□□■□□□■■■□□□■■□□□□■□■□□□□■□□□□□□□□□□■■□□□□□■■□□■■■■■■□□■□□□□□□■□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□■□□□□□■□□□□□■□□■□□□■□□■□■□□□■□■□□■■□□□□□□□□□□□□□■□□□■□□□■□□□□□□■□■□□□□□□■□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□■□□□□□■■■■■■■□■■■■■■■□■□□■□□■□■■■□□□□□□□□□□□□□□□□■■■□□□□■□□□□□□■□■□□□□□□■□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□■□□□□□■□□□□□■□■□□□□□■□■□□□■□■□■□□■■□□□□□□□□□□□□□□□■□□□□□■□□□□□□■□■□□□□□□■□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□■□□□□□■□□□□□■□■□□□□□■□■□□□□■■□■□□□□■□□□□□□□□□□□□□□■□□□□□□■■■■■■□□□■■■■■■□□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
		print("□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□□")
		print("\nThank You For Using This Program!\n")
		break
	
	elif value == 'database':
		for i in range(len(species)):
			print("\n< Data %d >" %(i+1))
			print("Species name : %s" %species[i])
			print("DNA sequence :\n%s" %values[i][0])
			print("Protein sequence :\n%s" %values[i][1])
		print()


	elif value[len(value)-1] == '%':
		print("\n< Run GC percent program >\n")
		for i in range(len(species)):
			if value == values[i][2]:
				print("This is %s's GC percentage!\n" %species[i])

	else:
		datatype = 'DNA'
		for i in range(len(value)):
			if value[i] != 'A' and value[i] != 'T' and value[i] != 'G' and value[i]!= 'C':
				datatype = 'Protein'
				break
		
		if datatype == 'DNA':
			
			print("\n1. Run DP to find similar alignment")
			print("2. Comparing Percantage of GC Contents")
			print("3. Find Palindromic Sequence")
			print("4. Run PSI-BLAST (DNA-RNA-Protein)")

			#print("\n1. Run DP")
			#print("2. Run PSI-BLAST")
			#print("3. Find Palindromic Sequence")
			#print("4. Compare Percentage of GC Contents")
			select = int(input("Write a number you want : "))

			if select == 1:
				print("\n< Run DP program >\n")
				subprocess.call("./DP.py %s" %value, shell=True)

			elif select == 4:
				print("< Run PSI-BLAST (DNA-RNA-Protein) >\n")
				print("- 1st step : Transcription")
				subprocess.call("./Transcribing.py %s" %value, shell=True)
				print("\n- 2nd step : Translation")
				DNA2RNA = input("Copy and Paste upper step result : ")
				subprocess.call("./Translating.py %s" %DNA2RNA, shell=True)
				print("\n- 3rd step : Run PSI-BLAST")
				RNA2AA = input("Copy and Past upper step result : ")
				print()
				subprocess.call("./Protein.py %s" %RNA2AA, shell=True)
				

			elif select == 3:
				print("\n< Run Find Palindromic Sequence >\n")
				print("\n- EXAMPLE -")
				print("Write the name of species : BMSE")
				print("The sequence of this EXAMPLE :\nAAAAAAAACCCCCCCCCCCAAAAAGGGGGGGGGGGGGGGGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACCCCCCCCCCCCTTTTTGGGGGGGGGGGGGGGGTTTTTTTTTTTTTTTTTTTTTTTTTCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC")
				subprocess.call("./RNAmapping.py TEST_gene.txt", shell=True)
				subprocess.call("./openFinalRNAmapping.py TEST_gene.txt", shell=True)

				print("\n- Your Action -")
				subprocess.call("./write_gene_txt.py %s" %value, shell=True)
				print()
				subprocess.call("./RNAmapping.py Gene.txt", shell=True)
				subprocess.call("./openFinalRNAmapping.py Gene.txt", shell=True)
				
			
			elif select == 2:
				print("\n< Run Compare Percentage of GC Contents >")
				subprocess.call("./GC.py %s" %value, shell=True)

			else:
				print("There is no choice that you want\n")


		else: #datatype == 'Protein'
			print("\n< Run PSI-BLAST(just Protein) >\n")
			subprocess.call("./Protein.py %s" %value, shell=True)



#subprocess.call("./Protein.py", shell=True)
